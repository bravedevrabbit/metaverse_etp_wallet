<ion-header>
    <ion-navbar>
        <button ion-button menuToggle>
        <ion-icon name="menu"></ion-icon>
    </button>
        <ion-title>{{ "ETP_BRIDGE" | translate}}</ion-title>
    </ion-navbar>
</ion-header>

<ion-content padding style="padding-bottom: 0;">

    <form #sendForm="ngForm" style="padding-bottom: 0;">
    
        <p align="center" *ngIf="etpBalance<fee/100000000" class="wrong-input">{{"NOTICE_TRANSACTION_FEE_UNCOVERED"|translate}}</p>
        <ion-row>
            <ion-col>
                <p>{{"AVAILABLE_BALANCE" | translate}}: <br *ngIf="platform.is('mobile')">{{etpBalance | format : 8}} ETP</p>
            </ion-col>
            <ion-col>
                <p class="right">{{"FEE"|translate}}:<br *ngIf="platform.is('mobile')"> {{fee | format : 8}} ETP</p>
            </ion-col>
        </ion-row>


        <ion-card class="card-block" *ngIf="bridgePairs">
            <ion-row>
                <ion-col col-md-5 col-sm-12 col-12>

                    <ion-item [ngClass]="{'valid-border': true}">
                        <ion-label color="primary" floating>{{"ETP_BRIDGE.FROM_ASSET" | translate}}</ion-label>
                        <ion-select [ngModel]="createOrderParameters.depositSymbol" name="depositSymbol" okText="{{'OK'|translate}}" cancelText="{{'CANCEL'|translate}}" (ngModelChange)="changeDepositSymbol($event)">
                            <ion-option *ngFor="let asset of depositSymbolList" value="{{asset}}">{{asset}}</ion-option>
                        </ion-select>
                    </ion-item>

                    <ion-item [ngClass]="{'error-border': !validDepositAmount(depositAmount), 'valid-border': validDepositAmount(depositAmount)}">
                        <ion-label color="primary" floating>{{"ETP_BRIDGE.AMOUNT_SEND" | translate}}</ion-label>
                        <ion-input [(ngModel)]="createOrderParameters.depositAmount" name="depositAmount" type="number" (ngModelChange)="updateReceiveAmount()"></ion-input>
                    </ion-item>
                    <div *ngIf="bridgeRate" no-lines class="advice" [translate]="'ETP_BRIDGE.MIN_MAX_DEPOSIT'" [translateParams]="{min: bridgeRate.depositMin, max: bridgeRate.depositMax, symbol: createOrderParameters.depositSymbol, fee: bridgeRate.depositCoinFeeRate*100}"></div>  

                    <ion-item *ngIf="" [ngClass]="{'error-border': !validRefundAddress()}">
                        <ion-label color="primary" floating [translate]="'ETP_BRIDGE.REFUND_ADDRESS'" [translateParams]="{symbol: createOrderParameters.depositSymbol}"></ion-label>
                        <ion-select [(ngModel)]="createOrderParameters.refundAddress" name="refundAddress" multiple="false" okText="{{'OK'|translate}}" cancelText="{{'CANCEL'|translate}}">
                            <ion-option *ngFor="let addressbalance of addressbalances" value="{{addressbalance.identifier}}">{{addressbalance.identifier}} - {{addressbalance.balance | format : 8}} ETP</ion-option>
                        </ion-select>
                    </ion-item>

                    <ion-item *ngIf="" [ngClass]="{'error-border': !validRefundAddress()}">
                        <ion-label color="primary" floating [translate]="'ETP_BRIDGE.REFUND_ADDRESS'" [translateParams]="{symbol: createOrderParameters.depositSymbol}"></ion-label>
                        <ion-input [(ngModel)]="createOrderParameters.refundAddress" name="refundAddress" type="text"></ion-input>
                    </ion-item>

                </ion-col>
                <ion-col col-md-2 col-sm-12 col-12>
                    <ion-icon id="swapIcon" name="swap" (click)="switch()"></ion-icon>
                    <div *ngIf="bridgeRate" id="rate" no-lines [translate]="'ETP_BRIDGE.RATE'" [translateParams]="{rate: bridgeRate.instantRate}"></div>
                </ion-col>
                <ion-col col-md-5 col-sm-12 col-12>

                    <ion-item [ngClass]="{'valid-border': true}">
                        <ion-label color="primary" floating>{{"ETP_BRIDGE.TO_ASSET" | translate}}</ion-label>
                        <ion-select [ngModel]="createOrderParameters.receiveSymbol" name="receiveSymbol" okText="{{'OK'|translate}}" cancelText="{{'CANCEL'|translate}}" (ngModelChange)="changeReceiveSymbol($event)">
                            <ion-option value="ETP">ETP</ion-option>
                            <ion-option *ngFor="let asset of bridgePairs['ETP']" value="{{asset}}">{{asset}}</ion-option>
                        </ion-select>
                    </ion-item>

                    <ion-item [ngClass]="{'error-border': true, 'valid-border': false}">
                        <ion-label color="primary" floating>{{"ETP_BRIDGE.AMOUNT_RECEIVE" | translate}}</ion-label>
                        <ion-input [(ngModel)]="createOrderParameters.receiveAmount" name="receiveAmount" type="number" disabled></ion-input>
                    </ion-item>
                    <div *ngIf="bridgeRate" no-lines class="advice" [translate]="'ETP_BRIDGE.RECEIVE_COIN_FEE'" [translateParams]="{fee: bridgeRate.receiveCoinFee, symbol: createOrderParameters.receiveSymbol}"></div>  

                    <ion-item *ngIf="" [ngClass]="{'error-border': !validRefundAddress()}">
                        <ion-label color="primary" floating [translate]="'ETP_BRIDGE.RECEIVE_ADDRESS'" [translateParams]="{symbol: createOrderParameters.receiveSymbol}"></ion-label>
                        <ion-select [(ngModel)]="createOrderParameters.receiveAddress" name="receiveAddress" multiple="false" okText="{{'OK'|translate}}" cancelText="{{'CANCEL'|translate}}">
                            <ion-option *ngFor="let addressbalance of addressbalances" value="{{addressbalance.identifier}}">{{addressbalance.identifier}} - {{addressbalance.balance | format : 8}} ETP</ion-option>
                        </ion-select>
                    </ion-item>
                
                </ion-col>
            </ion-row>

            <ion-row class="buttons-row">
                <ion-col>
                    <button type="submit" ion-button full icon-left (click)="sell()" color="secondary">
                        <ion-icon disabled="checked" name="send"></ion-icon>
                        {{"SWAP" | translate}}
                    </button>
                </ion-col>
                <ion-col>
                    <button ion-button color="danger" full item-right icon-left (click)="cancel($event)">
                        <ion-icon name="cancel"></ion-icon>
                        {{'CANCEL'|translate}}
                    </button>
                </ion-col>
            </ion-row>
        </ion-card>

        

    </form>

</ion-content>
